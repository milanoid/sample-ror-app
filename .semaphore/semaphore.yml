version: v1.0
name: Rails Sample Build
agent:
  machine:
    type: s1-runner01
    os_image: ''
#  containers:
#    - name: main
#      image: 'registry.semaphoreci.com/ruby:3.2.0'
#      env_vars:
#        - name: RAILS_ENV
#          value: test
blocks:
  - name: Build
    task:
      prologue:
        commands:
          - whoami
          - cat /etc/os-release
          - pwd
          - ls -la
          - ps aux | grep "agent"
          - checkout
          - ls -la
          - ruby --version
          - gem --version
      jobs:
        - name: Bundle Install
          commands:
            - bundle install --jobs=4 --retry=3
            - bundle exec rails --version
            - echo "Rails setup completed successfully!"
